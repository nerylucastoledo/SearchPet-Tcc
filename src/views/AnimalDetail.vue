<template>
    <div class="container">
        <h1 class="titulo">{{anuncio.nome}}</h1>

        <div class="perfil-animal">
            <img 
                v-if="anuncio.imagem" 
                :src="anuncio.imagem" 
                alt="Imagem de um animal"
            >

            <div class="info-animal">
                <div>
                    <div class="box-info">
                        <div>
                            <h2>Idade</h2>

                           <img src="../assets/idade.png" alt="Calendario">
                        </div>

                        <span>{{anuncio.idade}}</span>
                    </div>

                    <div class="box-info">
                        <div>
                            <h2>Sexo</h2>

                            <img src="../assets/sexo.png" alt="Logo Sexo">
                        </div>

                        <p :class="[anuncio.sexo === 'Macho' ? 'macho' : 'femea']">
                            {{anuncio.sexo}}
                        </p>
                    </div>
                </div>

                <div>
                    <div class="box-info">
                        <div>
                            <h2>Peso</h2>

                            <img src="../assets/peso.png" alt="Logo peso">
                        </div>

                        <span>{{anuncio.peso}} Kg</span>
                    </div>

                    <div class="box-info">
                        <div>
                            <h2>Castrado</h2>

                            <img src="../assets/castrado.png" alt="Logo pata">
                        </div>

                        <span v-if="anuncio.castrado === false">N√£o castrado</span>
                        <span v-else>Castrado</span>
                    </div>
                </div>
            </div>
        </div>
        
        <div v-if="!anuncio.pausado">
            <h2 v-if="anuncio.categoria === 'Adocao'" class="titulo">Voc√™ pode me adotar üê∂</h2>
            <h2 v-else class="titulo">Ajude a me encontrar üê∂</h2>

            <div>
                <div>
                    <p>
                        Minha ONG:

                        <strong>{{dono.nameOng}}</strong>
                    </p>

                    <p>
                        Ligue para:
                        <strong>{{dono.whatsapp}}</strong>
                    </p>
                </div>

                <div>
                    <p>
                        Endere√ßo: 
                        <strong>{{dono.street}}</strong>
                    </p>

                    <p>
                        Bairro 
                        <strong>{{dono.district}}</strong>
                    </p>
                </div>
            </div>
        </div>

        <div v-else>
            <div v-if="anuncio.categoria === 'Adocao'" class="info-adocao">
                <h1 class="titulo">Informa√ß√µes da ado√ß√£o</h1>

                <div>
                    <h2>Nome:</h2>
                    <span>{{anuncio.nome_finalizado}}</span>
                </div>

                <div>
                    <h2>Data da ado√ß√£o</h2>
                    <span>{{anuncio.data_finalizdo}}</span>
                </div>

                <div>
                    <h2>N√∫mero da pessoa:</h2>
                    <span>{{anuncio.contato_finalizado}}</span>
                </div>
            </div>
        </div>

        <a v-if="!anuncio.pausado" target= "_blank" :href="whatsapp">
            <button class="button-whatsapp">
                <span>Me chame</span>

                <img src="../assets/whatsapp.png" alt="Loggo do Whatsapp">
            </button>
        </a>

        <PorqueAdotar/>
    </div>
</template>

<script>

import PorqueAdotar from '../components/PorqueAdotar.vue'
import firebase from 'firebase'

export default {

    components: {
        PorqueAdotar,
    },

    data() {
        return {
            anuncio: '',
            dono: '',
            whatsapp: ''
        }
    },

    watch: {
        anuncio() {
            return this.anuncio
        }
    },

    methods: {
        getDono() {
            const userName = this.$store.state.user.data.displayName

            firebase.database()
            .ref(userName)
            .once("value", snapshot => {
                this.dono = snapshot.val()

                this.whatsapp = `https://api.whatsapp.com/send?phone=55${this.dono.whatsapp}&amp;text=Entrei%20pelo%20site.%20Esta%20podendo%20falar%20agora?%20`
            })
        }
    },

    mounted() {
        const id = this.$route.params.id
        const anuncio = this.$route.params.anuncio

        firebase.database().ref('/Anuncios/' + anuncio)
        .child(id)
        .once("value", snapshot => {
            this.anuncio = snapshot.val()

            this.getDono()
        })
    },

    beforeCreate() {
        const logado = sessionStorage.getItem('login')
        
        if(!logado) {
            this.$router.replace({ name: "login" });
        }
    }
    
}
</script>

<style scoped>

.container {
    padding: 0 230px;
}

.perfil-animal {
    margin-top: 60px;
}

.perfil-animal img {
    border-radius: 10px;
    width: 50%;
    max-height: 400px;
    object-fit: cover;
}

.perfil-animal {
    display: flex;
}

.perfil-animal > .info-animal {
    display: flex;
    width: 50%;
}

.info-animal > div {
    width: 100%;
    margin-left: 30px;
}

.info-animal > div > div {
    box-shadow: 0px 7px 7px rgba(0, 0, 0, 0.25);
    margin-bottom: 30px;
    border-radius: 10px;
    padding: 20px;
    text-align: center;
}
.box-info img {
    width: 30px;
    height: 30px;
    position: absolute;
    left: 0px;
    top: 0px;
}

.box-info p, .box-info span {
    font-weight: bold;
}

.box-info h2 {
    font-weight: normal;
}

.box-info > div {
    position: relative;
    justify-content: center;
}

.box-info h2 {
    margin-bottom: 20px;
}

.button-whatsapp {
    background-color: #25D366;
    display: block;
    margin: 60px auto 0px auto;
    border: none;
    border-radius: 10px;
    width: 320px;
    padding: 10px 0;
    cursor: pointer;
    display: flex;
    justify-content: center;
    align-items: center;
    color: #fff;
    font-size: 24px;
}

.button-whatsapp span{
    margin-right: 20px;
}

.button-whatsapp:hover {
    transform: scale(1.1);
    transition: .3s;
}


</style>